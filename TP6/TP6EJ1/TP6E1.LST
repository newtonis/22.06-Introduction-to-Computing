################################################################################
#                                                                              #
#    Micro Series 6801 Assembler V2.00/DOS              20/Sep/16  08:50:15    #
#                                                                              #
#       Source   =   tp6e1.msa                                                 #
#       List     =   tp6e1.lst                                                 #
#       Object   =   tp6e1.r07                                                 #
#       Options  =                                                             #
#                                                                              #
#                                               (c) Copyright IAR Systems 1990 #
################################################################################


    1  0000                   p68h11
    2                 
    3  4000           STRING  equ     $4000
    4  4001           OUT     equ     $4001
    5                 
    6  5000                   org     $5000
    7                 
    8  5000           strlen  equ     *
    9                 
   10  5000 8600              ldaa    #$00    ;inicio en 0 el contador de la longitud del string
   11                 
   12  5002 E600      inicio  ldab    0,X     ;cargo en B el actual caracter de string a leer
   13  5004 4C                inca            ;incremento longitud del string en un caracter
   14  5005 08                inx
   15  5006 C100              cmpb    #$00    ;reviso si llegue al ultimo caracter
   16  5008 26F8              bne     inicio  ;en cuyo caso vuelvo a contar
   17  500A 4A                deca            ;ajusto longitud de string medida
   18  500B A704              staa    4,X     ;guardo resultado del calculo
   19                 
   20  500D 39                rts
   21                 
   22  2000                   org     $2000
   23  2000 8E5031            lds     #stackp
   24                 
   25  2003 CE4000            ldx     #STRING ; cargo puntero al inicio del string    
   26                         
   27  2006 BD5000            jsr     strlen          
   28                         
   29  2009 B74001            staa    OUT
   30                         
   31  200C 3F                swi
   32                 
   33                 
   34  4000                   org     STRING
   35  4000 456C2073          fcc     'El stack es muy util'
       4004 7461636B
       4008 20657320
       400C 6D757920
       4010 7574696C
   36  4014 00                fcb     $00
   37                 
   38  5000                   ORG     $5000
   39  5000           stack   rmb     50      ;Reservo espacio para el stac
   40  5031           stackp  equ     *-1
   41                 
   42                 
   43  5032                   END     

    Errors:  None          #########
    Bytes:   48            # tp6e1 #
    CRC:     40E1          #########

